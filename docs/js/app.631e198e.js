(function(){"use strict";var t={5559:function(t,e,n){var o=n(3751),i=n(641);function s(t,e,n,o,s,r){const a=(0,i.g2)("v-toolbar-title"),l=(0,i.g2)("v-spacer"),c=(0,i.g2)("router-link"),d=(0,i.g2)("v-btn"),u=(0,i.g2)("v-app-bar"),f=(0,i.g2)("router-view"),p=(0,i.g2)("v-container"),m=(0,i.g2)("v-main"),h=(0,i.g2)("v-footer"),g=(0,i.g2)("v-app");return(0,i.uX)(),(0,i.Wv)(g,null,{default:(0,i.k6)((()=>[(0,i.bF)(u,{app:"",color:"indigo",dark:""},{default:(0,i.k6)((()=>[(0,i.bF)(a,null,{default:(0,i.k6)((()=>e[0]||(e[0]=[(0,i.eW)("3D Battle")]))),_:1}),(0,i.bF)(l),(0,i.bF)(d,{text:""},{default:(0,i.k6)((()=>[(0,i.bF)(c,{to:"/",class:"nav-link"},{default:(0,i.k6)((()=>e[1]||(e[1]=[(0,i.eW)("Home")]))),_:1})])),_:1}),(0,i.bF)(d,{text:""},{default:(0,i.k6)((()=>[(0,i.bF)(c,{to:"/battle",class:"nav-link"},{default:(0,i.k6)((()=>e[2]||(e[2]=[(0,i.eW)("Battle")]))),_:1})])),_:1}),(0,i.bF)(d,{text:""},{default:(0,i.k6)((()=>[(0,i.bF)(c,{to:"/ranking",class:"nav-link"},{default:(0,i.k6)((()=>e[3]||(e[3]=[(0,i.eW)("Ranking")]))),_:1})])),_:1})])),_:1}),(0,i.bF)(m,null,{default:(0,i.k6)((()=>[(0,i.bF)(p,null,{default:(0,i.k6)((()=>[(0,i.bF)(f)])),_:1})])),_:1}),(0,i.bF)(h,{class:"bg-indigo lighten-1 text-center d-flex flex-column pa-4 height-10px"})])),_:1})}var r={name:"App"},a=n(6262);const l=(0,a.A)(r,[["render",s]]);var c=l,d=n(6166);function u(t,e,n,o,s,r){return(0,i.uX)(),(0,i.CE)("h1",null,"Home")}var f={name:"HomePage"};const p=(0,a.A)(f,[["render",u]]);var m=p;function h(t,e,n,o,s,r){const a=(0,i.g2)("v-app");return(0,i.uX)(),(0,i.Wv)(a,null,{default:(0,i.k6)((()=>e[0]||(e[0]=[(0,i.Lk)("div",{class:"three-container"},[(0,i.Lk)("canvas",{id:"three-canvas"}),(0,i.Lk)("button",{id:"up"},"↑"),(0,i.Lk)("button",{id:"down"},"↓"),(0,i.Lk)("button",{id:"left"},"←"),(0,i.Lk)("button",{id:"right"},"→")],-1)]))),_:1})}n(4114);var g=n(9437),v={name:"BattleScene",data(){return{ws:null,game:null,state:"start"}},mounted(){this.createWebSocket(),this.initThree()},methods:{createWebSocket(){this.ws=new WebSocket("ws://localhost:8000/ws"),this.ws.onopen=()=>{console.log("WebSocket connected")},this.ws.onclose=()=>{console.log("WebSocket closed")},this.ws.onmessage=t=>{this.game=JSON.parse(t.data),console.log(this.game)}},initThree(){const t=new g.Z58;this.game={ball:["","","","","","","","","","","","","","","","","",""],winner:"",turn:0,player:"B"};let e=[];t.add(new g.fTw(1e3,1e3));const n=new g.ubm(75,window.innerWidth/window.innerHeight,.1,1e3);n.position.z=10.8,n.position.y=10,n.position.x=3.2;const o=new g.JeP({canvas:document.getElementById("three-canvas")});o.setSize(window.innerWidth,window.innerHeight);const i=t=>{for(let e=0;e<16;e++)for(let n=0;n<t.ball[e].length;n++)l(e,n,"");for(let e=0;e<16;e++)if(""!==t.ball[e])for(let n=0;n<t.ball[e].length;n++)l(e,n,t.ball[e][n])};this.ws.onmessage=t=>{if(this.game=JSON.parse(t.data),i(this.game),null!==this.game.winner)return alert(this.game.winner+"の勝ちです"),void this.ws.send(JSON.stringify({action:"end"}))};const s=()=>{const n=new g.iNn(10,3,10),o=new g.V9B({color:232644061}),i=new g.eaF(n,o);t.add(i),i.position.x=0,i.position.z=0;const s=new g.Ho_(.5,.3,6),r=2,a=-3,l=-3,c=3;for(let d=0;d<16;d++){let n=new g.V9B({color:14596231}),o=new g.eaF(s,n);o.position.x=a+r*Math.floor(d/4),o.position.y=c,o.position.z=l+r*(d%4),e.push(o),t.add(o)}};s();const r=function(){requestAnimationFrame(r),o.render(t,n)},a=function(){let t=0;document.getElementById("up").addEventListener("mousedown",(function(){t=1})),document.getElementById("down").addEventListener("mousedown",(function(){t=2})),document.getElementById("left").addEventListener("mousedown",(function(){t=3})),document.getElementById("right").addEventListener("mousedown",(function(){t=4})),document.getElementById("up").addEventListener("mouseup",(function(){t=0})),document.getElementById("down").addEventListener("mouseup",(function(){t=0})),document.getElementById("left").addEventListener("mouseup",(function(){t=0})),document.getElementById("right").addEventListener("mouseup",(function(){t=0})),document.getElementById("up").addEventListener("touchstart",(function(){t=1})),document.getElementById("down").addEventListener("touchstart",(function(){t=2})),document.getElementById("left").addEventListener("touchstart",(function(){t=3})),document.getElementById("right").addEventListener("touchstart",(function(){t=4})),document.getElementById("up").addEventListener("touchend",(function(){t=0})),document.getElementById("down").addEventListener("touchend",(function(){t=0})),document.getElementById("left").addEventListener("touchend",(function(){t=0})),document.getElementById("right").addEventListener("touchend",(function(){t=0}));const e=.03,o=15;let i=Math.PI/3,s=Math.PI/3;const r=function(){switch(t){case 1:if(i>=4*Math.PI/10)break;i+=e;break;case 2:if(i<=-4*Math.PI/10)break;i-=e;break;case 3:s+=e;break;case 4:s-=e;break}n.position.x=o*Math.cos(i)*Math.cos(s),n.position.z=o*Math.cos(i)*Math.sin(s),n.position.y=o*Math.sin(i),n.lookAt(new g.Pq0(0,0,0))};setInterval(r,1e3/60)};a();const l=(n,o,i)=>{const s=.7,r=new g.Gu$(s,32,32);if("W"===i){const i=new g.V9B({color:16777215}),s=new g.eaF(r,i);return s.position.x=e[n].position.x,s.position.y=e[n].position.y-.3+o,s.position.z=e[n].position.z,void t.add(s)}if("B"===i){const i=new g.V9B({color:0}),s=new g.eaF(r,i);return s.position.x=e[n].position.x,s.position.y=e[n].position.y-.3+o,s.position.z=e[n].position.z,void t.add(s)}return null};let c=null;const d=s=>{const r=new g.tBo,a=new g.I9Y,l=s.clientX,d=s.clientY,u=o.domElement.width,f=o.domElement.height;a.x=l/u*2-1,a.y=-d/f*2+1,r.setFromCamera(a,n);const p=r.intersectObjects(t.children);if(p.length>0){if(16777215===p[0].object.material.color.getHex())return;if(16711680===p[0].object.material.color.getHex()){for(let t=0;t<16;t++)if(e[t]===c){if(4===this.game.ball[t].length)return;let e={action:"put",cylinder:t,color:this.game.player};this.ws.send(JSON.stringify(e)),i(this.game)}return p[0].object.material.color.set(14596231),void(c=null)}if(14596231===p[0].object.material.color.getHex())return null!==c&&c.material.color.set(14596231),p[0].object.material.color.set(16711680),void(c=p[0].object)}};let u=0;const f=new g.Ho_(.5,.3,1),p=new g.V9B({color:16711680}),m=new g.eaF(f,p);m.position.x=e[u].position.x,m.position.y=e[u].position.y+4,m.position.z=e[u].position.z,t.add(m),c=e[u],document.addEventListener("click",d,!1),document.addEventListener("touchstart",d,!1),window.addEventListener("beforeunload",(()=>{this.ws.send(JSON.stringify({action:"end"}))})),document.addEventListener("keydown",(t=>{if("a"===t.key&&this.ws.send(JSON.stringify({action:"end"})),"ArrowRight"===t.key&&(u++,u>15&&(u=0),m.position.x=e[u].position.x,m.position.y=e[u].position.y+4,m.position.z=e[u].position.z,c=e[u]),"ArrowLeft"===t.key&&(u--,u<0&&(u=15),m.position.x=e[u].position.x,m.position.y=e[u].position.y+4,m.position.z=e[u].position.z,c=e[u]),"ArrowDown"===t.key&&(u+=4,u>15&&(u-=16),m.position.x=e[u].position.x,m.position.y=e[u].position.y+4,m.position.z=e[u].position.z,c=e[u]),"ArrowUp"===t.key&&(u-=4,u<0&&(u+=16),m.position.x=e[u].position.x,m.position.y=e[u].position.y+4,m.position.z=e[u].position.z,c=e[u]),"Enter"===t.key){if(4===this.game.ball[u].length)return;let t={action:"put",cylinder:u,color:this.game.player};this.ws.send(JSON.stringify(t)),i(this.game)}})),r()}}};const w=(0,a.A)(v,[["render",h],["__scopeId","data-v-396a6402"]]);var b=w;const y=[{path:"/",name:"Home",component:m},{path:"/battle",name:"Battle",component:b}],k=(0,d.aE)({history:(0,d.Bt)(),routes:y});var E=k,x=(n(5524),n(4825)),B=n(2938),L=n(3379),I=n(1050);const _=(0,x.$N)({components:B,directives:L,icons:{defaultSet:"mdi",aliases:I.z,sets:{mdi:I.r}}});(0,o.Ef)(c).use(E).use(_).mount("#app")}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var s=e[o]={exports:{}};return t[o].call(s.exports,s,s.exports,n),s.exports}n.m=t,function(){var t=[];n.O=function(e,o,i,s){if(!o){var r=1/0;for(d=0;d<t.length;d++){o=t[d][0],i=t[d][1],s=t[d][2];for(var a=!0,l=0;l<o.length;l++)(!1&s||r>=s)&&Object.keys(n.O).every((function(t){return n.O[t](o[l])}))?o.splice(l--,1):(a=!1,s<r&&(r=s));if(a){t.splice(d--,1);var c=i();void 0!==c&&(e=c)}}return e}s=s||0;for(var d=t.length;d>0&&t[d-1][2]>s;d--)t[d]=t[d-1];t[d]=[o,i,s]}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var i,s,r=o[0],a=o[1],l=o[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)var d=l(n)}for(e&&e(o);c<r.length;c++)s=r[c],n.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return n.O(d)},o=self["webpackChunk_3d_battle"]=self["webpackChunk_3d_battle"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(5559)}));o=n.O(o)})();
//# sourceMappingURL=app.631e198e.js.map